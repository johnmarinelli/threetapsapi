<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>3taps Data Commons Search API</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="searchapi_files/stylesheet.css">
    <script type="text/javascript">
  function do_print() {
    var w = window.open("", "_blank", "height=400,width=600,location=0");
    w.document.write("<html>");
    w.document.write("  <head>");
    w.document.write("    <title>3taps Data Commons Search API</title>");
    w.document.write("   <link rel=\"stylesheet\" type=\"text/css\" href=\"stylesheet.css\">");
    w.document.write("  </head>");
    w.document.write("  <body>");
    w.document.write("<p><center>");
    w.document.write("    <h1>");
    w.document.write("        The 3taps Data Commons");
    w.document.write("    </h1>");
    w.document.write("    <h3>");
    w.document.write("        The Search API");
    w.document.write("    </h3>");
    w.document.write("</center></p>");
    w.document.write("<p>The 3taps Search API is responsible for searching against the database of");
    w.document.write("postings.  For example, it can be used to find all postings from a particular");
    w.document.write("data source, category and location, or to find postings with a given annotation");
    w.document.write("value.</p>");
    w.document.write("<p>There are two ways in which the Search API can be used:</p>");
    w.document.write("<ul>");
    w.document.write("<li>In <strong>search</strong> mode, the caller supplies a set of <em>search criteria</em>, and the");
    w.document.write("Search API returns a set of <em>matching postings</em>:</li>");
    w.document.write("</ul>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-1.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<ul>");
    w.document.write("<li>In <strong>count</strong> mode, the caller again supplies a set of search criteria, but");
    w.document.write("   also supplies a <em>count field</em> which is used to calculating the number of");
    w.document.write("   matching postings with a given field value.  For example:</li>");
    w.document.write("</ul>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-2.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>To improve performance, the Search API makes use of two important concepts:</p>");
    w.document.write("<ul>");
    w.document.write("<li>The posting data is <strong>tiered</strong> so that the most recent data can be found");
    w.document.write("   quickly, and older results can still be found but may take longer.");
    w.document.write("<br><br></li>");
    w.document.write("<li>The set of matching postings are <strong>paginated</strong> to keep the search process");
    w.document.write("   manageable.</li>");
    w.document.write("</ul>");
    w.document.write("<p>Let's take a closer look at these two concepts.</p>");
    w.document.write("<h3>Tiered Search</h3>");
    w.document.write("<p>When it comes to postings, time is very important: recent postings are far more");
    w.document.write("likely to be relevant than older postings.  To improve the performance of the");
    w.document.write("3taps Search API, the postings are divided into <strong>tiers</strong>, where the first tier");
    w.document.write("is optimised to access the most recent postings as quickly as possible.  Older");
    w.document.write("postings are still available in subsequent tiers, though they may take longer");
    w.document.write("to access:</p>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-3.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>The exact number of tiers in the database is not hardwired, and there is no");
    w.document.write("guarantee that a given tier will cover a given period of time.  What is");
    w.document.write("certain, however, is that tier 0 will contain the most recent or most \"active\"");
    w.document.write("postings, and should always be tried first for any given search</p>");
    w.document.write("<p>By default, all requests to the 3taps Search API will search for postings in");
    w.document.write("tier 0.  This can be overridden by supplying a <code>tier=N</code> parameter when making");
    w.document.write("your request.</p>");
    w.document.write("<p>Note that the Search API will tell you which tier to use for obtaining more");
    w.document.write("results, in the <code>next_tier</code> field.</p>");
    w.document.write("<h3>Pagination of Search Results</h3>");
    w.document.write("<p>A search request will often find too many postings to return all at once.  For");
    w.document.write("example, imagine a search for the word \"the\" in a tier of the posting database");
    w.document.write("consisting of 17 million postings.  This search may well return 12 million");
    w.document.write("postings -- there is no way the Search API could read all those postings from");
    w.document.write("the database tier, bundle them up and return them back to the caller all at");
    w.document.write("once.  Such a request would take several minutes at least, and the client would");
    w.document.write("probably choke on the huge packet of data that was returned.</p>");
    w.document.write("<p>To avoid this, the search API makes use of pagination -- that is, an initial");
    w.document.write("search will return the first page of search results, which would typically be");
    w.document.write("the \"N\" most recent matching postings within the specified tier:</p>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-4.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>To retrieve more postings, the caller makes another call to the Search API,");
    w.document.write("asking for the second page of results:</p>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-5.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>More calls can be made to retrieve more postings, going further and further");
    w.document.write("back through the posting database.</p>");
    w.document.write("<p>There is, however, a problem with this pagination model: the posting database");
    w.document.write("is not static.  New postings are being added all the time, pushing the existing");
    w.document.write("postings further back in time.  What this means for the Search API is ambiguous");
    w.document.write("-- how should the Search API interpret the concept of the \"second page of");
    w.document.write("search results\" when new postings have been added to the database?</p>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-6.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>To avoid this issue, the Search API returns an <strong>anchor</strong> along with the search");
    w.document.write("results themselves:</p>");
    w.document.write("<p><center>");
    w.document.write("    <img src=\"images/search-7.png\"/>");
    w.document.write("</center></p>");
    w.document.write("<p>This anchor is used to keep the pages of search results in the same place in");
    w.document.write("the posting database, even as new postings come in.  The anchor is also used to");
    w.document.write("tell the caller that more postings have been added to the database since the");
    w.document.write("initial search was made.</p>");
    w.document.write("<p>Note that the 3taps Search API will tell you which page number to use to obtain");
    w.document.write("more results, in the <code>next_page</code> field.  If the current tier has no more");
    w.document.write("matches, the <code>next_page</code> field will be reset to zero as you move to the next");
    w.document.write("tier.</p>");
    w.document.write("<h3>Search Criteria</h3>");
    w.document.write("<p>A search request can include the following search criteria:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>category_group</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps category grouping code.  Note that this parameter can");
    w.document.write("include logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>category</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps category code.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.country</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps country code, or \"*\" to search for all postings which");
    w.document.write("have a country value.  Note that this parameter can include logical");
    w.document.write("operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.state</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps state, or \"*\" to search for all postings which have a");
    w.document.write("state value.  Note that this parameter can include logical operators, as");
    w.document.write("described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.metro</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps metro area code, or \"*\" to search for all postings which");
    w.document.write("have a metro value.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.region</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps region code, or \"*\" to search for all postings which have");
    w.document.write("a metro value.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.county</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps county code, or \"*\" to search for all postings which have");
    w.document.write("a metro value.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.city</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps city code, or \"*\" to search for all postings which have a");
    w.document.write("metro value.  Note that this parameter can include logical");
    w.document.write("operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.locality</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps locality code, or \"*\" to search for all postings which");
    w.document.write("have a metro value.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location.zipcode</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps ZIP code, or \"*\" to search for all postings which have a");
    w.document.write("metro value.  Note that this parameter can include logical");
    w.document.write("operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>radius</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired radius for a radius-based search.  This should be a string");
    w.document.write("consisting of a number and a suffix, like this:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>radius=10.2mi</code></p>");
    w.document.write("</blockquote>");
    w.document.write("<p>The number can be any whole or floating point value, and the following");
    w.document.write("suffixes are currently supported:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>ft</code> = feet. <br>");
    w.document.write("<code>m</code> = meters. <br>");
    w.document.write("<code>mi</code> = miles. <br>");
    w.document.write("<code>km</code> = kilometers.   </p>");
    w.document.write("</blockquote>");
    w.document.write("<p>There is no default value for the units.  If a suffix is not supplied, the");
    w.document.write("search request will be rejected and an error returned back to the caller;");
    w.document.write("this is to prevent confusion where, for example, the user assumes the");
    w.document.write("radius is in miles but it is actually in metres, and surprising results are");
    w.document.write("returned.</p>");
    w.document.write("<p>Note that if the <code>radius</code> parameter is supplied, the <code>lat</code> and <code>long</code>");
    w.document.write("parameters must also be supplied.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>lat</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired latitude for a radius-based search, in decimal degrees.  Note");
    w.document.write("that this parameter can also be used for distance-based sorting, as");
    w.document.write("described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>long</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired longitude for a radius-based search, in decimal degrees.  Note");
    w.document.write("that this parameter can also be used for distance-based sorting, as");
    w.document.write("described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>source</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired 3taps source code.  Note that this parameter can include");
    w.document.write("logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>external_id</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired external ID for a posting.  Note that external ID values are");
    w.document.write("guaranteed to be unique for a single data source, but the same value may be");
    w.document.write("used across sources.  For this reason, you would normally search for both");
    w.document.write("the source and the external ID at the same time.  Note that this parameter");
    w.document.write("can include logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>heading</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A freeform text string.  Only postings with the given string in their");
    w.document.write("heading will be included in the search results.  Note that this parameter");
    w.document.write("can make use of text operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>body</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A freeform text string.  Only postings with the given string in their body");
    w.document.write("will be included in the search results.  Note that this parameter can make");
    w.document.write("use of text operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>text</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A freeform text string.  Only postings with the given string in their");
    w.document.write("heading or body will be included in the search results.  Note that this");
    w.document.write("parameter can make use of text operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>timestamp</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>This parameter is used to only include postings with a given range of");
    w.document.write("timestamp values.  The timestamp parameter can either be set to the special");
    w.document.write("value <code>all</code> to match all postings, or alternatively you can use one of the");
    w.document.write("following three formats to specify a desired date/time range:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>MIN_TIMESTAMP..MAX_TIMESTAMP   ");
    w.document.write("MIN_TIMESTAMP..   ");
    w.document.write("..MAX_TIMESTAMP");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>MIN_TIMESTAMP</code> and <code>MAX_TIMESTAMP</code> represent the minimum and maximum");
    w.document.write("timestamp values, respectively.  If both are supplied, then only postings");
    w.document.write("within the given range of timestamp values will be included in the search");
    w.document.write("results.  If only a minimum timestamp is supplied, only postings later than");
    w.document.write("that timestamp will be included.  Similarly, if only a maximum timestamp is");
    w.document.write("supplied, only postings earlier than that timestamp will be included.</p>");
    w.document.write("<p>Timestamp value can be represented in one of the following ways:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>1364387696</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An integer value represents a \"unix time\" value -- that is, the number");
    w.document.write("of seconds since the 1st of January, 1970, in UTC.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>2013-03-27 12:34:56</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string containing hyphens or colons are interpreted as a date/time");
    w.document.write("value, in UTC.  The following formats are accepted:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>YYYY-MM-DD</code><br>");
    w.document.write("<code>YYYY-MM-DD HH:MM</code><br>");
    w.document.write("<code>YYYY-MM-DD HH:MM:SS</code>  </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>7d</strong><br>");
    w.document.write("<strong>30m</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string consisting of a number following by a single letter represents");
    w.document.write("a <em>relative time</em> value.  The timestamp is calculated relative to the");
    w.document.write("current date and time.  For example, if the current date and time is");
    w.document.write("<code>2013-03-28 12:06:30</code>, and the relative time value is <code>30m</code>, then the");
    w.document.write("timestamp will be calculated as 30 minutes ago -- ie, <code>2013-03-28");
    w.document.write("11:36:30</code>.</p>");
    w.document.write("<p>The following relative timestamp codes are currently supported:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>s</code> = seconds. <br>");
    w.document.write("<code>m</code> = minutes. <br>");
    w.document.write("<code>h</code> = hours. <br>");
    w.document.write("<code>d</code> = days. <br>");
    w.document.write("<code>w</code> = weeks.  </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>id</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>This parameter can be used to search for a single posting with a single");
    w.document.write("record ID, or a number of postings within a given range of record IDs.  To");
    w.document.write("search against a single record ID, the value should simply be the integer");
    w.document.write("record ID, like this:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>?id=1234567");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>Alternatively, to search against a range of record IDs, the parameter");
    w.document.write("should look like this:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>?id=1234567..1234890");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>price</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>This parameter is used to only include postings with a given range of price");
    w.document.write("values.  The parameter's value should be a string formatted in one of the");
    w.document.write("following ways:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>MIN_PRICE..MAX_PRICE");
    w.document.write("MIN_PRICE..");
    w.document.write("..MAX_PRICE");
    w.document.write("*");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>MIN_PRICE</code> and <code>MAX_PRICE</code> represent the minimum and maximum price values.");
    w.document.write("If both are supplied, then only postings with the given range of price");
    w.document.write("values will be included in the search results.  If only a minimum price is");
    w.document.write("supplied, only postings greater than or equal to that minimum price will be");
    w.document.write("included.  Similarly, if only a maximum price is supplied, only postings");
    w.document.write("less than or equal to that maximum price will be included.</p>");
    w.document.write("<p>If the <code>price</code> criteria is set to <code>*</code>, the search will match all postings");
    w.document.write("which have a price.</p>");
    w.document.write("<p>Note that price values can be given as either integer or floating-point");
    w.document.write("values.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>currency</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Only include postings in the given currency.  The parameter's value should");
    w.document.write("be a 3-character ISO-4217 currency code.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>annotations</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A specially-formatted string identifying one or more annotation values.");
    w.document.write("Only postings which match the given annotation value(s) will be included in");
    w.document.write("the search results.</p>");
    w.document.write("<p>The value of this parameter should consist of one or more <code>key:value</code> pairs");
    w.document.write("separated by either <code>AND</code> or <code>OR</code>, and the whole string surrounded by <code>{</code>");
    w.document.write("and <code>}</code> characters.  For example:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>annotations={make:ford AND model:mustang}");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>Note that the value can be set to \"<code>*</code>\", which means that all postings will");
    w.document.write("be found that have the given annotation regardless of its value.  For");
    w.document.write("example, the following search criteria:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>annotations={size:large AND color:*}");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>will find all postings which have their <code>size</code> annotation set to <strong>large</strong>,");
    w.document.write("and which have a color.  Note that if you combine multiple annotation");
    w.document.write("comparisons, you can use parentheses to control the order in which they are");
    w.document.write("evaluated.  For example:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>annotations={(bedrooms:2br OR bedrooms:3br) AND dogs:yes}");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>status</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Only include postings with the given status value.  The following status");
    w.document.write("values are currently supported:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>registered   ");
    w.document.write("for_sale   ");
    w.document.write("for_hire      ");
    w.document.write("for_rent  ");
    w.document.write("wanted   ");
    w.document.write("lost   ");
    w.document.write("stolen   ");
    w.document.write("found");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>Note that this parameter can include logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>state</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The state the posting is in.  This will be one of the following values:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>available   ");
    w.document.write("unavailable   ");
    w.document.write("expired");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>Note that this parameter can include logical operators, as described below.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>has_image</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>If this parameter is supplied and has the value \"1\", only postings which");
    w.document.write("have an image will be included in the search results.  If this parameter");
    w.document.write("has the value \"0\", only postings which do not have images will be included");
    w.document.write("in the search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>has_price</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>If this parameter is supplied and has the value \"1\", only postings which");
    w.document.write("have a price value will be included in the search results.  If this");
    w.document.write("parameter has the value \"0\", only postings which do not have a price value");
    w.document.write("will be included in the search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>include_deleted</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>By default, deleted postings will not be included in the search results.");
    w.document.write("If this parameter is supplied and has the value \"1\", however, deleted");
    w.document.write("postings will be included in the search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>only_deleted</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>If this parameter is supplied and has the value \"1\", only deleted postings");
    w.document.write("will be included in the search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<h3>Logical Operators</h3>");
    w.document.write("<p>A number of parameters can make use of <em>logical operators</em> to allow for more");
    w.document.write("sophisticated search options.  For these parameters, a single value can be");
    w.document.write("supplied simply by providing the value itself, like this:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>category=SBIK");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>However, special characters can be used to change the way in which the");
    w.document.write("parameter is interpreted.  Two special characters are currently supported:</p>");
    w.document.write("<ul>");
    w.document.write("<li>");
    w.document.write("<p>The vertical bar or \"pipe\" character (\"<code>|</code>\") is used to calculate the");
    w.document.write("   logical <strong>OR</strong> of two or more values.  For example:</p>");
    w.document.write("<pre><code>  category=SBIK|SCAR");
    w.document.write("</code></pre>");
    w.document.write("<p>This means that the search would include postings with a category of");
    w.document.write(" either <code>SBIK</code> or <code>SCAR</code>.  Note that you can combine as many values as you");
    w.document.write(" like using the <code>|</code> operator:</p>");
    w.document.write("<pre><code>  category=SBIK|SCAR|STRU|SANT|...");
    w.document.write("</code></pre>");
    w.document.write("</li>");
    w.document.write("<li>");
    w.document.write("<p>The tilda character (\"<code>~</code>\") is used as a logical <strong>NOT</strong> operator.  For");
    w.document.write("   example:</p>");
    w.document.write("<pre><code>  category=~SBIK");
    w.document.write("</code></pre>");
    w.document.write("<p>would find all postings with a category that is not equal to <code>SBIK</code>.</p>");
    w.document.write("</li>");
    w.document.write("</ul>");
    w.document.write("<h3>Text Operators</h3>");
    w.document.write("<p>For text-based searches, the following operators can be used to perform more");
    w.document.write("sophisticated text searches.  Firstly, if multiple words (separate by spaces)");
    w.document.write("are provided, the search will find all postings with those individual words in");
    w.document.write("them.  For example, a search for:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code> heading=big bike");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>will find postings with the word \"big\" and the word \"bike\" in their heading.</p>");
    w.document.write("<p>To find postings with an exact phrase in them, surround the desired search text");
    w.document.write("with double quote characters, like this:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code> heading=\"big bike\"");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>This will only find postings containing the phrase \"big bike\".</p>");
    w.document.write("<p>The following text operators can be used, either with individual words or with");
    w.document.write("quoted phrases, to build more sophisticated searches:</p>");
    w.document.write("<ul>");
    w.document.write("<li>");
    w.document.write("<p>The vertical bar or \"pipe\" character (\"<code>|</code>\") can be used to calculate the");
    w.document.write("   logical <strong>OR</strong> of two or more words or phrases.  For example:</p>");
    w.document.write("<pre><code>  heading=big|bike");
    w.document.write("</code></pre>");
    w.document.write("<p>will find all postings with either \"big\" or \"bike\" in their heading.");
    w.document.write("<br><br>");
    w.document.write(" * The ampersand character (\"<code>&amp;</code>\") can be used as a logical <strong>AND</strong> operator.");
    w.document.write("   For example, a search for:</p>");
    w.document.write("<pre><code>  heading=\"big bike\"&amp;blue");
    w.document.write("</code></pre>");
    w.document.write("<p>will find all postings with both the phrase \"big bike\" and the word \"blue\"");
    w.document.write(" in them.");
    w.document.write("<br><br>");
    w.document.write(" * The tilda character (\"<code>~</code>\") can be used as a logical <strong>NOT</strong> operator.  For");
    w.document.write("   example, a search for:</p>");
    w.document.write("<pre><code>  heading=~\"big bike\"");
    w.document.write("</code></pre>");
    w.document.write("<p>will find all postings <em>without</em> the phrase \"big bike\" in their heading.</p>");
    w.document.write("</li>");
    w.document.write("</ul>");
    w.document.write("<p>Note that these text operators can be combined to yield quite complex text");
    w.document.write("searches.  For example:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code> heading=\"big bike\"&amp;~\"trek superfly\"");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>This will search for all postings containing the phrase \"big bike\", but without");
    w.document.write("the phrase \"trek superfly\".</p>");
    w.document.write("<h3>Radius-Based Searches</h3>");
    w.document.write("<p>The Search API allows you to find all postings within a given radius of a point");
    w.document.write("on the Earth's surface.  To perform a radius-based search, you need to supply");
    w.document.write("the following three parameters:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>lat=...</code> <br>");
    w.document.write("<code>long=...</code> <br>");
    w.document.write("<code>radius=...</code>   </p>");
    w.document.write("</blockquote>");
    w.document.write("<p>Note that when you request a radius-based search, only those postings which");
    w.document.write("have a latitude and longitude value within the given search radius will be");
    w.document.write("found.  Postings which do not have a latitude and longitude value, and postings");
    w.document.write("where this information is not correct, will not be included in the search");
    w.document.write("results.</p>");
    w.document.write("<h3>Sorting of Search Results</h3>");
    w.document.write("<p>By default, search results are returned in descending order of timestamp --");
    w.document.write("that is, the newest posting will be returned first.  This ordering can be");
    w.document.write("changed if desired, using the <code>sort</code> parameter.  The following sort orders are");
    w.document.write("currently supported:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>Timestamp</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>sort=timestamp</code></p>");
    w.document.write("<p>This sorts the postings in ascending time order -- that is, the oldest");
    w.document.write("posting will be found first.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>Reverse Timestamp</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>sort=-timestamp</code></p>");
    w.document.write("<p>This sorts the postings in descending time order -- that is, the newest");
    w.document.write("posting will be found first.  This is the default sort ordering for search");
    w.document.write("results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>Price</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>sort=price</code></p>");
    w.document.write("<p>This sorts the postings in ascending price order -- that is, the cheapest");
    w.document.write("posting will be found first.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>Reverse Price</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>sort=-price</code></p>");
    w.document.write("<p>This sorts the postings in in descending price order -- that is, the most");
    w.document.write("expensive posting will be found first.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>Distance</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>sort=distance</code></p>");
    w.document.write("<p>This sorts the postings by distance from a specified point.  When sorting");
    w.document.write("by distance, the closest postings will be found first.  To sort the");
    w.document.write("postings by distance, you must provide the following additional parameters:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>lat</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The latitude of the desired starting point, in decimal degrees.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>long</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The longitude of the desired starting point, in decimal degrees.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<hr>");
    w.document.write("<p><strong>Note that if you sort the postings by anything other than the default");
    w.document.write("(descending order of timestamp), the Search API may return postings in what");
    w.document.write("appears to be the \"wrong\" order if you search across tiers.  This is because");
    w.document.write("each tier has its own distinct set of postings.  So if, for example, you are");
    w.document.write("sorting your search results by ascending price, when you move from one tier");
    w.document.write("to the next your next page of search results will include the lowest-priced");
    w.document.write("postings <em>within that tier</em> -- even if you have received lower-priced postings");
    w.document.write("in an earlier page of results.  It is up to you to correctly sort the");
    w.document.write("postings when searching across multiple tiers with a non-default sort");
    w.document.write("order.</strong></p>");
    w.document.write("<hr>");
    w.document.write("</blockquote>");
    w.document.write("<h3>Index Searches</h3>");
    w.document.write("<p>While the Search API allows for general searching, it can also be used to");
    w.document.write("identify postings only by their internal record ID.  Searches can return a list");
    w.document.write("of record IDs that match a given set of criteria, returning only the ID and no");
    w.document.write("other additional details.  This is often useful for generating visualisations");
    w.document.write("based on the number of records that fall into certain groupings, without");
    w.document.write("wanting to display the details of the individual records.</p>");
    w.document.write("<p>To perform an index search, set the <code>retvals</code> parameter so that the Search API");
    w.document.write("will only return the record ID:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>retvals=id");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>When you do this, the number of matching records which can be returned in a");
    w.document.write("single page of search results (as controlled by the <code>rpp</code> parameter) can be");
    w.document.write("increased up to a maximum of 10,000.</p>");
    w.document.write("<h3>Count Mode</h3>");
    w.document.write("<p>When calling the Search API in count mode, you have to provide a <strong>count");
    w.document.write("field</strong> to use for calculating the counts.  The following fields can be used");
    w.document.write("for count mode:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>source</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each data source.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>category</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each unique category value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>category_group</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each unique category group");
    w.document.write("value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.country</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each country.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.state</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each state.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.metro</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each metro area.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.region</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each region.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.county</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings fore each county.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.city</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each city.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.locality</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each location.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>location.zipcode</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each ZIP code.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>language</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each ISO 639-1 language");
    w.document.write("code.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>currency</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each ISO 4217 currency code.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>status</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each status value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>state</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each state value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>flagged_status</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Calculates the number of matching postings for each flagged status value.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p>Upon completion, the Search API will return the number of matching postings for");
    w.document.write("each unique field value, rather than individual postings themselves.  For");
    w.document.write("example, a count by status might return the following:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p>registered = 816 <br>");
    w.document.write("for_sale = 4,612 <br>");
    w.document.write("for_hire = 1,208 <br>");
    w.document.write("wanted = 319 <br>");
    w.document.write("lost = 57 <br>");
    w.document.write("stolen = 63 <br>");
    w.document.write("found = 36   </p>");
    w.document.write("</blockquote>");
    w.document.write("<h3>Calling the 3taps Search API</h3>");
    w.document.write("<p>The Search API is accessed via a single entry point, which can be found at the");
    w.document.write("following URL:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code>http://search.3taps.com");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>The Search API call is made using an HTTP <code>GET</code> request to the above URL.  To");
    w.document.write("make a search request, pass the following parameters in addition to the search");
    w.document.write("criteria themselves:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>auth_token</code> <em>(required)</em></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The authentication token used to ensure that you are authorized to make");
    w.document.write("this API call.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>rpp</code> <em>(optional)</em></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The desired number of results per page.  This defaults to 10, but can be");
    w.document.write("set to any value from 1 to 100 for ordinary searches, and up to 10,000 for");
    w.document.write("index-only searches, as described above.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>retvals</code> <em>(optional)</em></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string listing the fields which should be returned back to the caller.");
    w.document.write("The various fields should be separated by commas.  At present, the");
    w.document.write("following fields can be included in this parameter:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>id</strong> <br>");
    w.document.write("<strong>account_id</strong> <br>");
    w.document.write("<strong>source</strong> <br>");
    w.document.write("<strong>category</strong> <br>");
    w.document.write("<strong>category_group</strong> <br>");
    w.document.write("<strong>location</strong> <br>");
    w.document.write("<strong>external_id</strong> <br>");
    w.document.write("<strong>external_url</strong> <br>");
    w.document.write("<strong>heading</strong> <br>");
    w.document.write("<strong>body</strong> <br>");
    w.document.write("<strong>timestamp</strong> <br>");
    w.document.write("<strong>timestamp_deleted</strong> <br>");
    w.document.write("<strong>expires</strong> <br>");
    w.document.write("<strong>language</strong> <br>");
    w.document.write("<strong>price</strong> <br>");
    w.document.write("<strong>currency</strong> <br>");
    w.document.write("<strong>images</strong> <br>");
    w.document.write("<strong>annotations</strong> <br>");
    w.document.write("<strong>status</strong> <br>");
    w.document.write("<strong>state</strong> <br>");
    w.document.write("<strong>immortal</strong> <br>");
    w.document.write("<strong>deleted</strong> <br>");
    w.document.write("<strong>flagged_status</strong>   </p>");
    w.document.write("</blockquote>");
    w.document.write("<p>If no <code>retvals</code> parameter is provided, the following default will be used:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>id</strong>");
    w.document.write("<strong>source</strong> <br>");
    w.document.write("<strong>category</strong> <br>");
    w.document.write("<strong>location</strong> <br>");
    w.document.write("<strong>external_id</strong> <br>");
    w.document.write("<strong>external_url</strong> <br>");
    w.document.write("<strong>heading</strong> <br>");
    w.document.write("<strong>timestamp</strong>   </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>sort</code> <em>(optional)</em></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string indicating the desired sort order to use for the found postings.");
    w.document.write("The following sort orders are currently supported:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>timestamp</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Sort the postings in ascending order of timestamp (ie, oldest to");
    w.document.write("newest).</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>-timestamp</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Sort the postings in descending order of timestamp (ie, newest to");
    w.document.write("oldest).</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>price</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Sort the postings in ascending order of price (ie, cheapest to most");
    w.document.write("expensive).</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>-price</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Sort the postings in descending order of price (ie, most expensive to");
    w.document.write("cheapest).</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>distance</strong></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Sort the postings in ascending order of distance (ie, closest to");
    w.document.write("furthest) from the point defined by the <code>lat</code> and <code>long</code> parameters.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p>If no <code>sort</code> parameter is provided, a default value of <code>-timestamp</code> will");
    w.document.write("be used (ie, sorting from newest to oldest).</p>");
    w.document.write("<blockquote>");
    w.document.write("<hr>");
    w.document.write("<p><strong>WARNING</strong>: when sorting the postings by price, make sure you include a");
    w.document.write("currency in the search criteria.  Otherwise, the search results will");
    w.document.write("include postings in different currencies, and the sort order will be");
    w.document.write("meaningless.</p>");
    w.document.write("<hr>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>count</code> <em>(optional)</em></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string containing the field to use for calculating the count.  Supplying");
    w.document.write("this parameter enables count mode.  The following values can be supplied");
    w.document.write("for this parameter:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>source</strong> <br>");
    w.document.write("<strong>category</strong> <br>");
    w.document.write("<strong>category_group</strong> <br>");
    w.document.write("<strong>location.country</strong> <br>");
    w.document.write("<strong>location.state</strong> <br>");
    w.document.write("<strong>location.metro</strong> <br>");
    w.document.write("<strong>location.region</strong> <br>");
    w.document.write("<strong>location.county</strong> <br>");
    w.document.write("<strong>location.city</strong> <br>");
    w.document.write("<strong>location.locality</strong> <br>");
    w.document.write("<strong>location.zipcode</strong> <br>");
    w.document.write("<strong>language</strong> <br>");
    w.document.write("<strong>currency</strong> <br>");
    w.document.write("<strong>status</strong> <br>");
    w.document.write("<strong>state</strong> <br>");
    w.document.write("<strong>flagged_status</strong>   </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p>Upon completion, the Search API will send back a response with a Content-Type");
    w.document.write("of <code>application/json</code>, and the body of the response will be a JSON-formatted");
    w.document.write("object.  The contents of this object will vary depending on whethe the search");
    w.document.write("API was called in search mode or count mode.</p>");
    w.document.write("<h4>Search Mode Results</h4>");
    w.document.write("<p>In search mode, the JSON-formatted object returned in the body of the HTTP");
    w.document.write("response will include the following fields:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>success</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A boolean indicating whether or not the search request succeeded.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>error</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>If the search request was not successfully processed, this will be a string");
    w.document.write("describing what went wrong.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>anchor</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>This will be a string that can be used in subsequent search requests to");
    w.document.write("ensure that the pagination is consistent even if new postings are received.");
    w.document.write("See above for details.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>next_page</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The \"page\" value to use to obtain the next set of search results.   If");
    w.document.write("there are no more results, a value of -1 will be returned.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>next_tier</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The \"tier\" value to use to obtain the next set of search results.  If there");
    w.document.write("are no more results, a value of -1 will be returned.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>postings</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An array containing the found postings, in the order specified by the");
    w.document.write("<code>sort=...</code> parameter.  Each entry in this array will be an object with all");
    w.document.write("or some of the following fields, depending on the value of the <code>retvals</code>");
    w.document.write("parameter, above:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>id</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The internal record ID used to uniquely identify this posting.  Note");
    w.document.write("that this will be a (possibly very large) integer.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>account_id</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string identifying the user who submitted the posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>source</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The code for the source system where this posting originated from.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>category</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps category code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>category_group</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps category group code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>location</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An object with some or all of the following fields:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>lat</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The latitude of this posting, in decimal degrees.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>long</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The longitude of this posting, in decimal degrees.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>accuracy</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An integer indicating the accuracy of the supplied lat/long value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>country</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps country code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>state</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps state code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>metro</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps metro area code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>region</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps region code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>county</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps county code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>city</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps city code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>locality</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps locality code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>zipcode</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3taps ZIP code for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>formatted_address</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string containing the address associated with this posting as a");
    w.document.write("one-line string, if this information is available.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>external_id</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string that uniquely identifies the posting in the source system.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>external_url</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A URL pointing to the original posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>heading</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string containing the heading for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>body</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A string containing the body of this posting, in plain (unformatted)");
    w.document.write("text.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>timestamp</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The date and time at which the posting was created, as an integer");
    w.document.write("number of seconds since the 1st of January 1970 (\"unix time\"), in UTC.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>timestamp_deleted</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The date and time at which the posting was deleted, as an integer");
    w.document.write("number of seconds since the 1st of January 1970 (\"unix time\"), in UTC.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>expires</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The date and time at which this posting should expire, as an integer");
    w.document.write("number of seconds since the 1st of January 1970 (\"unix time\"), in UTC. </p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>language</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 2-character ISO 639-1 language code indicating which language the");
    w.document.write("posting is in.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>price</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The price associated with this posting, if any.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>currency</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The 3-character ISO-4217 currency code indicating which currency the");
    w.document.write("price is in.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>images</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An array of image objects representing the images associated with this");
    w.document.write("posting. Each image object can have the following fields:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>full</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The URL pointing to the full-sized image for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>full_width</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The width, in pixels, for the full-sized image, if known.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>full_height</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The height, in pixels, for the full-sized image, if known.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>thumbnail</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The URL pointing to a thumbnail-sized image for this posting.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>thumbnail_width</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The width, in pixels, for the thumbnail-sized image, if known.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>thumbnail_height</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The height, in pixels, for the thumbnail-sized image, if known.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>annotations</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A object holding the various annotations to associate with this");
    w.document.write("posting. Each field in this object maps the annotation name to its");
    w.document.write("associated value, formatted as a string.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>status</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The posting's current status.  This will be one of the following");
    w.document.write("values:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>registered</code> <br>");
    w.document.write("<code>for_sale</code> <br>");
    w.document.write("<code>for_hire</code> <br>");
    w.document.write("<code>for_rent</code><br>");
    w.document.write("<code>wanted</code> <br>");
    w.document.write("<code>lost</code> <br>");
    w.document.write("<code>stolen</code> <br>");
    w.document.write("<code>found</code>   </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>state</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The current state of the posting.  This will be one of the following");
    w.document.write("values:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>available</code> <br>");
    w.document.write("<code>unavailable</code> <br>");
    w.document.write("<code>expired</code>   </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>immortal</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>true</strong> if the posting is immortal (ie, never expires), <strong>false</strong>");
    w.document.write("otherwise.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>deleted</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p><strong>true</strong> if the posting is deleted, <strong>false</strong> otherwise.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>flagged_status</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A number indicating the current \"flagged\" status of the posting.  This");
    w.document.write("will be one of the following values:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>0</code> = The posting has never been flagged. <br>");
    w.document.write("<code>1</code> = The posting has been flagged by a user. <br>");
    w.document.write("<code>2</code> = The flagged status was overruled.   </p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>num_matches</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The total number of matching postings found by this search.  Note that this");
    w.document.write("is the number of matching postings in the database, not the number of");
    w.document.write("postings actually returned in the current page of search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>time_taken</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The total time taken to process this search request, in milliseconds.  The");
    w.document.write("total search time consists of the time taken to identify the matching");
    w.document.write("records (<code>time_search</code>), plus the time taken to fetch the desired set of");
    w.document.write("fields from those matching records (<code>time_fetch</code>).</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>time_search</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The time taken to identify the matching records, in milliseconds.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>time_fetch</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The time taken to fetch the search results once the matching records have");
    w.document.write("been identified, in milliseconds.  Note that this is only available for");
    w.document.write("tier 0 searches.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p>After making the initial search request, you can ask for more pages of results");
    w.document.write("by reissuing the search request with the following additional parameters:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>anchor</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The anchor value returned by the Search API when the first request was");
    w.document.write("made.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>page</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The page number for the desired page of postings.  You should use the value");
    w.document.write("returned by the previous call to the Search API in the <code>next_page</code> field to");
    w.document.write("obtain the next page of search results.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>tier</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>Which tier to use for the search.  You should use the value of returned by");
    w.document.write("the previous call to the Search API in the <code>next_tier</code> field to ensure that");
    w.document.write("you continue to search all the available postings in the 3taps system.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p><strong>WARNING:</strong> Make sure you also include the other parameters you passed when");
    w.document.write("making the original search request, in particular the search criteria and the");
    w.document.write("<code>rpp</code> value.  Changing these will result in the wrong set of postings being");
    w.document.write("returned.</p>");
    w.document.write("<p>The response will be the same as for the initial search request, with the");
    w.document.write("addition of one extra field in the returned JSON object:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>new_postings</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>This is the number of new postings which have been added to the database");
    w.document.write("since the initial search request was made.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("<p>Note that if new postings have come in, you can find these postings by");
    w.document.write("reissuing the search request without the <code>anchor</code> parameter.</p>");
    w.document.write("<h4>Count Mode Results</h4>");
    w.document.write("<p>In count mode, the JSON-formatted object returned in the body of the HTTP");
    w.document.write("response will include the following fields:</p>");
    w.document.write("<blockquote>");
    w.document.write("<p><code>success</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>A boolean indicating whether or not the search request succeeded.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>error</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>If the search request was not successfully processed, this will be a string");
    w.document.write("describing what went wrong.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>num_matches</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The total number of matching postings found by this search.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>counts</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>An array of values holding the various field values and the number of");
    w.document.write("matching postings with that field value.  For example, when performing a");
    w.document.write("search with <code>count=status</code>, the JSON object will include something like the");
    w.document.write("following:</p>");
    w.document.write("<blockquote>");
    w.document.write("<pre><code> \"counts\": [{\"count\": 816, \"term\": \"registered\"},");
    w.document.write("            {\"count\": 4612, \"term\": \"for_sale\"},");
    w.document.write("            {\"count\": 1208, \"term\": \"for_hire\"},");
    w.document.write("            {\"count\": 910,  \"term\": \"for_rent\"},");
    w.document.write("            {\"count\": 319, \"term\": \"wanted\"},");
    w.document.write("            {\"count\": 57, \"term\": \"lost\"},");
    w.document.write("            {\"count\": 63, \"term\": \"stolen\"},");
    w.document.write("            {\"count\": 36, \"term\": \"found\"}]");
    w.document.write("</code></pre>");
    w.document.write("</blockquote>");
    w.document.write("<p>As you can see, each item in the returned array is an object with <code>count</code>");
    w.document.write("and <code>term</code> fields, where <code>term</code> is the value of the count field, and");
    w.document.write("<code>count</code> is the number of matching postings with that count field value.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>time_taken</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The total time taken to process this search request, in milliseconds.</p>");
    w.document.write("</blockquote>");
    w.document.write("<p><code>time_search</code></p>");
    w.document.write("<blockquote>");
    w.document.write("<p>The time taken to identify the matching records, in milliseconds.</p>");
    w.document.write("</blockquote>");
    w.document.write("</blockquote>");
    w.document.write("  </body>");
    w.document.write("</html>");
    w.print();
    w.close();
    return true;
  }
</script>
  </head>
  <body class="normal">
    <div class="header">
      <div class="backlink">
  <a href="http://docs.3taps.com/index.html">Back</a>
</div>
<div class="print_link">
  <a href="#" onclick="do_print()">Print</a>
</div>
<div class="version_selector">
  <span>
view
&nbsp;
<select size="1" onchange="document.location.href=this.value">
<option value="" selected="selected">the latest version</option>
<option value="search_api-since-1399324301.html">changes made since the version dated 06 May 2014, 09:11 AM</option>
<option value="search_api-since-1378872424.html">changes made since the version dated 11 Sep 2013, 04:07 PM</option>
<option value="search_api-since-1378781048.html">changes made since the version dated 10 Sep 2013, 02:44 PM</option>
<option value="search_api-since-1377560862.html">changes made since the version dated 27 Aug 2013, 11:47 AM</option>
<option value="search_api-since-1373317623.html">changes made since the version dated 09 Jul 2013, 09:07 AM</option>
<option value="search_api-since-1372988804.html">changes made since the version dated 05 Jul 2013, 01:46 PM</option>
<option value="search_api-since-1372902407.html">changes made since the version dated 04 Jul 2013, 01:46 PM</option>
<option value="search_api-since-1371676823.html">changes made since the version dated 20 Jun 2013, 09:20 AM</option>
<option value="search_api-since-1370985679.html">changes made since the version dated 12 Jun 2013, 09:21 AM</option>
<option value="search_api-since-1368656040.html">changes made since the version dated 16 May 2013, 10:14 AM</option>
<option value="search_api-since-1368477767.html">changes made since the version dated 14 May 2013, 08:42 AM</option>
<option value="search_api-since-1368125767.html">changes made since the version dated 10 May 2013, 06:56 AM</option>
<option value="search_api-since-1368125010.html">changes made since the version dated 10 May 2013, 06:43 AM</option>
<option value="search_api-since-1366578175.html">changes made since the version dated 22 Apr 2013, 09:02 AM</option>
<option value="search_api-since-1365704976.html">changes made since the version dated 12 Apr 2013, 06:29 AM</option>
<option value="search_api-since-1365560801.html">changes made since the version dated 10 Apr 2013, 02:26 PM</option>
<option value="search_api-since-1365559859.html">changes made since the version dated 10 Apr 2013, 02:10 PM</option>
<option value="search_api-since-1365546801.html">changes made since the version dated 10 Apr 2013, 10:33 AM</option>
</select>
</span>
</div>
    </div>
    <div class="contents">
      <div id="wrapper">
        <p></p><center>
    <h1>
        The 3taps Data Commons
    </h1>
    <h3>
        The Search API
    </h3>
</center><p></p>
<p>The 3taps Search API is responsible for searching against the database of
postings.  For example, it can be used to find all postings from a particular
data source, category and location, or to find postings with a given annotation
value.</p>
<p>There are two ways in which the Search API can be used:</p>
<ul>
<li>In <strong>search</strong> mode, the caller supplies a set of <em>search criteria</em>, and the
Search API returns a set of <em>matching postings</em>:</li>
</ul>
<p></p><center>
    <img src="searchapi_files/search-1.png">
</center><p></p>
<ul>
<li>In <strong>count</strong> mode, the caller again supplies a set of search criteria, but
   also supplies a <em>count field</em> which is used to calculating the number of
   matching postings with a given field value.  For example:</li>
</ul>
<p></p><center>
    <img src="searchapi_files/search-2.png">
</center><p></p>
<p>To improve performance, the Search API makes use of two important concepts:</p>
<ul>
<li>The posting data is <strong>tiered</strong> so that the most recent data can be found
   quickly, and older results can still be found but may take longer.
<br><br></li>
<li>The set of matching postings are <strong>paginated</strong> to keep the search process
   manageable.</li>
</ul>
<p>Let's take a closer look at these two concepts.</p>
<h3>Tiered Search</h3>
<p>When it comes to postings, time is very important: recent postings are far more
likely to be relevant than older postings.  To improve the performance of the
3taps Search API, the postings are divided into <strong>tiers</strong>, where the first tier
is optimised to access the most recent postings as quickly as possible.  Older
postings are still available in subsequent tiers, though they may take longer
to access:</p>
<p></p><center>
    <img src="searchapi_files/search-3.png">
</center><p></p>
<p>The exact number of tiers in the database is not hardwired, and there is no
guarantee that a given tier will cover a given period of time.  What is
certain, however, is that tier 0 will contain the most recent or most "active"
postings, and should always be tried first for any given search</p>
<p>By default, all requests to the 3taps Search API will search for postings in
tier 0.  This can be overridden by supplying a <code>tier=N</code> parameter when making
your request.</p>
<p>Note that the Search API will tell you which tier to use for obtaining more
results, in the <code>next_tier</code> field.</p>
<h3>Pagination of Search Results</h3>
<p>A search request will often find too many postings to return all at once.  For
example, imagine a search for the word "the" in a tier of the posting database
consisting of 17 million postings.  This search may well return 12 million
postings -- there is no way the Search API could read all those postings from
the database tier, bundle them up and return them back to the caller all at
once.  Such a request would take several minutes at least, and the client would
probably choke on the huge packet of data that was returned.</p>
<p>To avoid this, the search API makes use of pagination -- that is, an initial
search will return the first page of search results, which would typically be
the "N" most recent matching postings within the specified tier:</p>
<p></p><center>
    <img src="searchapi_files/search-4.png">
</center><p></p>
<p>To retrieve more postings, the caller makes another call to the Search API,
asking for the second page of results:</p>
<p></p><center>
    <img src="searchapi_files/search-5.png">
</center><p></p>
<p>More calls can be made to retrieve more postings, going further and further
back through the posting database.</p>
<p>There is, however, a problem with this pagination model: the posting database
is not static.  New postings are being added all the time, pushing the existing
postings further back in time.  What this means for the Search API is ambiguous
-- how should the Search API interpret the concept of the "second page of
search results" when new postings have been added to the database?</p>
<p></p><center>
    <img src="searchapi_files/search-6.png">
</center><p></p>
<p>To avoid this issue, the Search API returns an <strong>anchor</strong> along with the search
results themselves:</p>
<p></p><center>
    <img src="searchapi_files/search-7.png">
</center><p></p>
<p>This anchor is used to keep the pages of search results in the same place in
the posting database, even as new postings come in.  The anchor is also used to
tell the caller that more postings have been added to the database since the
initial search was made.</p>
<p>Note that the 3taps Search API will tell you which page number to use to obtain
more results, in the <code>next_page</code> field.  If the current tier has no more
matches, the <code>next_page</code> field will be reset to zero as you move to the next
tier.</p>
<h3>Search Criteria</h3>
<p>A search request can include the following search criteria:</p>
<blockquote>
<p><code>category_group</code></p>
<blockquote>
<p>The desired 3taps category grouping code.  Note that this parameter can
include logical operators, as described below.</p>
</blockquote>
<p><code>category</code></p>
<blockquote>
<p>The desired 3taps category code.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>location.country</code></p>
<blockquote>
<p>The desired 3taps country code, or "*" to search for all postings which
have a country value.  Note that this parameter can include logical
operators, as described below.</p>
</blockquote>
<p><code>location.state</code></p>
<blockquote>
<p>The desired 3taps state, or "*" to search for all postings which have a
state value.  Note that this parameter can include logical operators, as
described below.</p>
</blockquote>
<p><code>location.metro</code></p>
<blockquote>
<p>The desired 3taps metro area code, or "*" to search for all postings which
have a metro value.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>location.region</code></p>
<blockquote>
<p>The desired 3taps region code, or "*" to search for all postings which have
a metro value.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>location.county</code></p>
<blockquote>
<p>The desired 3taps county code, or "*" to search for all postings which have
a metro value.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>location.city</code></p>
<blockquote>
<p>The desired 3taps city code, or "*" to search for all postings which have a
metro value.  Note that this parameter can include logical
operators, as described below.</p>
</blockquote>
<p><code>location.locality</code></p>
<blockquote>
<p>The desired 3taps locality code, or "*" to search for all postings which
have a metro value.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>location.zipcode</code></p>
<blockquote>
<p>The desired 3taps ZIP code, or "*" to search for all postings which have a
metro value.  Note that this parameter can include logical
operators, as described below.</p>
</blockquote>
<p><code>radius</code></p>
<blockquote>
<p>The desired radius for a radius-based search.  This should be a string
consisting of a number and a suffix, like this:</p>
<blockquote>
<p><code>radius=10.2mi</code></p>
</blockquote>
<p>The number can be any whole or floating point value, and the following
suffixes are currently supported:</p>
<blockquote>
<p><code>ft</code> = feet. <br>
<code>m</code> = meters. <br>
<code>mi</code> = miles. <br>
<code>km</code> = kilometers.   </p>
</blockquote>
<p>There is no default value for the units.  If a suffix is not supplied, the
search request will be rejected and an error returned back to the caller;
this is to prevent confusion where, for example, the user assumes the
radius is in miles but it is actually in metres, and surprising results are
returned.</p>
<p>Note that if the <code>radius</code> parameter is supplied, the <code>lat</code> and <code>long</code>
parameters must also be supplied.</p>
</blockquote>
<p><code>lat</code></p>
<blockquote>
<p>The desired latitude for a radius-based search, in decimal degrees.  Note
that this parameter can also be used for distance-based sorting, as
described below.</p>
</blockquote>
<p><code>long</code></p>
<blockquote>
<p>The desired longitude for a radius-based search, in decimal degrees.  Note
that this parameter can also be used for distance-based sorting, as
described below.</p>
</blockquote>
<p><code>source</code></p>
<blockquote>
<p>The desired 3taps source code.  Note that this parameter can include
logical operators, as described below.</p>
</blockquote>
<p><code>external_id</code></p>
<blockquote>
<p>The desired external ID for a posting.  Note that external ID values are
guaranteed to be unique for a single data source, but the same value may be
used across sources.  For this reason, you would normally search for both
the source and the external ID at the same time.  Note that this parameter
can include logical operators, as described below.</p>
</blockquote>
<p><code>heading</code></p>
<blockquote>
<p>A freeform text string.  Only postings with the given string in their
heading will be included in the search results.  Note that this parameter
can make use of text operators, as described below.</p>
</blockquote>
<p><code>body</code></p>
<blockquote>
<p>A freeform text string.  Only postings with the given string in their body
will be included in the search results.  Note that this parameter can make
use of text operators, as described below.</p>
</blockquote>
<p><code>text</code></p>
<blockquote>
<p>A freeform text string.  Only postings with the given string in their
heading or body will be included in the search results.  Note that this
parameter can make use of text operators, as described below.</p>
</blockquote>
<p><code>timestamp</code></p>
<blockquote>
<p>This parameter is used to only include postings with a given range of
timestamp values.  The timestamp parameter can either be set to the special
value <code>all</code> to match all postings, or alternatively you can use one of the
following three formats to specify a desired date/time range:</p>
<blockquote>
<pre><code>MIN_TIMESTAMP..MAX_TIMESTAMP   
MIN_TIMESTAMP..   
..MAX_TIMESTAMP
</code></pre>
</blockquote>
<p><code>MIN_TIMESTAMP</code> and <code>MAX_TIMESTAMP</code> represent the minimum and maximum
timestamp values, respectively.  If both are supplied, then only postings
within the given range of timestamp values will be included in the search
results.  If only a minimum timestamp is supplied, only postings later than
that timestamp will be included.  Similarly, if only a maximum timestamp is
supplied, only postings earlier than that timestamp will be included.</p>
<p>Timestamp value can be represented in one of the following ways:</p>
<blockquote>
<p><strong>1364387696</strong></p>
<blockquote>
<p>An integer value represents a "unix time" value -- that is, the number
of seconds since the 1st of January, 1970, in UTC.</p>
</blockquote>
<p><strong>2013-03-27 12:34:56</strong></p>
<blockquote>
<p>A string containing hyphens or colons are interpreted as a date/time
value, in UTC.  The following formats are accepted:</p>
<blockquote>
<p><code>YYYY-MM-DD</code><br>
<code>YYYY-MM-DD HH:MM</code><br>
<code>YYYY-MM-DD HH:MM:SS</code>  </p>
</blockquote>
</blockquote>
<p><strong>7d</strong><br>
<strong>30m</strong></p>
<blockquote>
<p>A string consisting of a number following by a single letter represents
a <em>relative time</em> value.  The timestamp is calculated relative to the
current date and time.  For example, if the current date and time is
<code>2013-03-28 12:06:30</code>, and the relative time value is <code>30m</code>, then the
timestamp will be calculated as 30 minutes ago -- ie, <code>2013-03-28
11:36:30</code>.</p>
<p>The following relative timestamp codes are currently supported:</p>
<blockquote>
<p><code>s</code> = seconds. <br>
<code>m</code> = minutes. <br>
<code>h</code> = hours. <br>
<code>d</code> = days. <br>
<code>w</code> = weeks.  </p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p><code>id</code></p>
<blockquote>
<p>This parameter can be used to search for a single posting with a single
record ID, or a number of postings within a given range of record IDs.  To
search against a single record ID, the value should simply be the integer
record ID, like this:</p>
<blockquote>
<pre><code>?id=1234567
</code></pre>
</blockquote>
<p>Alternatively, to search against a range of record IDs, the parameter
should look like this:</p>
<blockquote>
<pre><code>?id=1234567..1234890
</code></pre>
</blockquote>
</blockquote>
<p><code>price</code></p>
<blockquote>
<p>This parameter is used to only include postings with a given range of price
values.  The parameter's value should be a string formatted in one of the
following ways:</p>
<blockquote>
<pre><code>MIN_PRICE..MAX_PRICE
MIN_PRICE..
..MAX_PRICE
*
</code></pre>
</blockquote>
<p><code>MIN_PRICE</code> and <code>MAX_PRICE</code> represent the minimum and maximum price values.
If both are supplied, then only postings with the given range of price
values will be included in the search results.  If only a minimum price is
supplied, only postings greater than or equal to that minimum price will be
included.  Similarly, if only a maximum price is supplied, only postings
less than or equal to that maximum price will be included.</p>
<p>If the <code>price</code> criteria is set to <code>*</code>, the search will match all postings
which have a price.</p>
<p>Note that price values can be given as either integer or floating-point
values.</p>
</blockquote>
<p><code>currency</code></p>
<blockquote>
<p>Only include postings in the given currency.  The parameter's value should
be a 3-character ISO-4217 currency code.</p>
</blockquote>
<p><code>annotations</code></p>
<blockquote>
<p>A specially-formatted string identifying one or more annotation values.
Only postings which match the given annotation value(s) will be included in
the search results.</p>
<p>The value of this parameter should consist of one or more <code>key:value</code> pairs
separated by either <code>AND</code> or <code>OR</code>, and the whole string surrounded by <code>{</code>
and <code>}</code> characters.  For example:</p>
<blockquote>
<pre><code>annotations={make:ford AND model:mustang}
</code></pre>
</blockquote>
<p>Note that the value can be set to "<code>*</code>", which means that all postings will
be found that have the given annotation regardless of its value.  For
example, the following search criteria:</p>
<blockquote>
<pre><code>annotations={size:large AND color:*}
</code></pre>
</blockquote>
<p>will find all postings which have their <code>size</code> annotation set to <strong>large</strong>,
and which have a color.  Note that if you combine multiple annotation
comparisons, you can use parentheses to control the order in which they are
evaluated.  For example:</p>
<blockquote>
<pre><code>annotations={(bedrooms:2br OR bedrooms:3br) AND dogs:yes}
</code></pre>
</blockquote>
</blockquote>
<p><code>status</code></p>
<blockquote>
<p>Only include postings with the given status value.  The following status
values are currently supported:</p>
<blockquote>
<pre><code>registered   
for_sale   
for_hire      
for_rent  
wanted   
lost   
stolen   
found
</code></pre>
</blockquote>
<p>Note that this parameter can include logical operators, as described below.</p>
</blockquote>
<p><code>state</code></p>
<blockquote>
<p>The state the posting is in.  This will be one of the following values:</p>
<blockquote>
<pre><code>available   
unavailable   
expired
</code></pre>
</blockquote>
<p>Note that this parameter can include logical operators, as described below.</p>
</blockquote>
<p><code>has_image</code></p>
<blockquote>
<p>If this parameter is supplied and has the value "1", only postings which
have an image will be included in the search results.  If this parameter
has the value "0", only postings which do not have images will be included
in the search results.</p>
</blockquote>
<p><code>has_price</code></p>
<blockquote>
<p>If this parameter is supplied and has the value "1", only postings which
have a price value will be included in the search results.  If this
parameter has the value "0", only postings which do not have a price value
will be included in the search results.</p>
</blockquote>
<p><code>include_deleted</code></p>
<blockquote>
<p>By default, deleted postings will not be included in the search results.
If this parameter is supplied and has the value "1", however, deleted
postings will be included in the search results.</p>
</blockquote>
<p><code>only_deleted</code></p>
<blockquote>
<p>If this parameter is supplied and has the value "1", only deleted postings
will be included in the search results.</p>
</blockquote>
</blockquote>
<h3>Logical Operators</h3>
<p>A number of parameters can make use of <em>logical operators</em> to allow for more
sophisticated search options.  For these parameters, a single value can be
supplied simply by providing the value itself, like this:</p>
<blockquote>
<pre><code>category=SBIK
</code></pre>
</blockquote>
<p>However, special characters can be used to change the way in which the
parameter is interpreted.  Two special characters are currently supported:</p>
<ul>
<li>
<p>The vertical bar or "pipe" character ("<code>|</code>") is used to calculate the
   logical <strong>OR</strong> of two or more values.  For example:</p>
<pre><code>  category=SBIK|SCAR
</code></pre>
<p>This means that the search would include postings with a category of
 either <code>SBIK</code> or <code>SCAR</code>.  Note that you can combine as many values as you
 like using the <code>|</code> operator:</p>
<pre><code>  category=SBIK|SCAR|STRU|SANT|...
</code></pre>
</li>
<li>
<p>The tilda character ("<code>~</code>") is used as a logical <strong>NOT</strong> operator.  For
   example:</p>
<pre><code>  category=~SBIK
</code></pre>
<p>would find all postings with a category that is not equal to <code>SBIK</code>.</p>
</li>
</ul>
<h3>Text Operators</h3>
<p>For text-based searches, the following operators can be used to perform more
sophisticated text searches.  Firstly, if multiple words (separate by spaces)
are provided, the search will find all postings with those individual words in
them.  For example, a search for:</p>
<blockquote>
<pre><code> heading=big bike
</code></pre>
</blockquote>
<p>will find postings with the word "big" and the word "bike" in their heading.</p>
<p>To find postings with an exact phrase in them, surround the desired search text
with double quote characters, like this:</p>
<blockquote>
<pre><code> heading="big bike"
</code></pre>
</blockquote>
<p>This will only find postings containing the phrase "big bike".</p>
<p>The following text operators can be used, either with individual words or with
quoted phrases, to build more sophisticated searches:</p>
<ul>
<li>
<p>The vertical bar or "pipe" character ("<code>|</code>") can be used to calculate the
   logical <strong>OR</strong> of two or more words or phrases.  For example:</p>
<pre><code>  heading=big|bike
</code></pre>
<p>will find all postings with either "big" or "bike" in their heading.
<br><br>
 * The ampersand character ("<code>&amp;</code>") can be used as a logical <strong>AND</strong> operator.
   For example, a search for:</p>
<pre><code>  heading="big bike"&amp;blue
</code></pre>
<p>will find all postings with both the phrase "big bike" and the word "blue"
 in them.
<br><br>
 * The tilda character ("<code>~</code>") can be used as a logical <strong>NOT</strong> operator.  For
   example, a search for:</p>
<pre><code>  heading=~"big bike"
</code></pre>
<p>will find all postings <em>without</em> the phrase "big bike" in their heading.</p>
</li>
</ul>
<p>Note that these text operators can be combined to yield quite complex text
searches.  For example:</p>
<blockquote>
<pre><code> heading="big bike"&amp;~"trek superfly"
</code></pre>
</blockquote>
<p>This will search for all postings containing the phrase "big bike", but without
the phrase "trek superfly".</p>
<h3>Radius-Based Searches</h3>
<p>The Search API allows you to find all postings within a given radius of a point
on the Earth's surface.  To perform a radius-based search, you need to supply
the following three parameters:</p>
<blockquote>
<p><code>lat=...</code> <br>
<code>long=...</code> <br>
<code>radius=...</code>   </p>
</blockquote>
<p>Note that when you request a radius-based search, only those postings which
have a latitude and longitude value within the given search radius will be
found.  Postings which do not have a latitude and longitude value, and postings
where this information is not correct, will not be included in the search
results.</p>
<h3>Sorting of Search Results</h3>
<p>By default, search results are returned in descending order of timestamp --
that is, the newest posting will be returned first.  This ordering can be
changed if desired, using the <code>sort</code> parameter.  The following sort orders are
currently supported:</p>
<blockquote>
<p><strong>Timestamp</strong></p>
<blockquote>
<p><code>sort=timestamp</code></p>
<p>This sorts the postings in ascending time order -- that is, the oldest
posting will be found first.</p>
</blockquote>
<p><strong>Reverse Timestamp</strong></p>
<blockquote>
<p><code>sort=-timestamp</code></p>
<p>This sorts the postings in descending time order -- that is, the newest
posting will be found first.  This is the default sort ordering for search
results.</p>
</blockquote>
<p><strong>Price</strong></p>
<blockquote>
<p><code>sort=price</code></p>
<p>This sorts the postings in ascending price order -- that is, the cheapest
posting will be found first.</p>
</blockquote>
<p><strong>Reverse Price</strong></p>
<blockquote>
<p><code>sort=-price</code></p>
<p>This sorts the postings in in descending price order -- that is, the most
expensive posting will be found first.</p>
</blockquote>
<p><strong>Distance</strong></p>
<blockquote>
<p><code>sort=distance</code></p>
<p>This sorts the postings by distance from a specified point.  When sorting
by distance, the closest postings will be found first.  To sort the
postings by distance, you must provide the following additional parameters:</p>
<blockquote>
<p><code>lat</code></p>
<blockquote>
<p>The latitude of the desired starting point, in decimal degrees.</p>
</blockquote>
<p><code>long</code></p>
<blockquote>
<p>The longitude of the desired starting point, in decimal degrees.</p>
</blockquote>
</blockquote>
</blockquote>
<hr>
<p><strong>Note that if you sort the postings by anything other than the default
(descending order of timestamp), the Search API may return postings in what
appears to be the "wrong" order if you search across tiers.  This is because
each tier has its own distinct set of postings.  So if, for example, you are
sorting your search results by ascending price, when you move from one tier
to the next your next page of search results will include the lowest-priced
postings <em>within that tier</em> -- even if you have received lower-priced postings
in an earlier page of results.  It is up to you to correctly sort the
postings when searching across multiple tiers with a non-default sort
order.</strong></p>
<hr>
</blockquote>
<h3>Index Searches</h3>
<p>While the Search API allows for general searching, it can also be used to
identify postings only by their internal record ID.  Searches can return a list
of record IDs that match a given set of criteria, returning only the ID and no
other additional details.  This is often useful for generating visualisations
based on the number of records that fall into certain groupings, without
wanting to display the details of the individual records.</p>
<p>To perform an index search, set the <code>retvals</code> parameter so that the Search API
will only return the record ID:</p>
<blockquote>
<pre><code>retvals=id
</code></pre>
</blockquote>
<p>When you do this, the number of matching records which can be returned in a
single page of search results (as controlled by the <code>rpp</code> parameter) can be
increased up to a maximum of 10,000.</p>
<h3>Count Mode</h3>
<p>When calling the Search API in count mode, you have to provide a <strong>count
field</strong> to use for calculating the counts.  The following fields can be used
for count mode:</p>
<blockquote>
<p><strong>source</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each data source.</p>
</blockquote>
<p><strong>category</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each unique category value.</p>
</blockquote>
<p><strong>category_group</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each unique category group
value.</p>
</blockquote>
<p><strong>location.country</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each country.</p>
</blockquote>
<p><strong>location.state</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each state.</p>
</blockquote>
<p><strong>location.metro</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each metro area.</p>
</blockquote>
<p><strong>location.region</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each region.</p>
</blockquote>
<p><strong>location.county</strong></p>
<blockquote>
<p>Calculates the number of matching postings fore each county.</p>
</blockquote>
<p><strong>location.city</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each city.</p>
</blockquote>
<p><strong>location.locality</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each location.</p>
</blockquote>
<p><strong>location.zipcode</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each ZIP code.</p>
</blockquote>
<p><strong>language</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each ISO 639-1 language
code.</p>
</blockquote>
<p><strong>currency</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each ISO 4217 currency code.</p>
</blockquote>
<p><strong>status</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each status value.</p>
</blockquote>
<p><strong>state</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each state value.</p>
</blockquote>
<p><strong>flagged_status</strong></p>
<blockquote>
<p>Calculates the number of matching postings for each flagged status value.</p>
</blockquote>
</blockquote>
<p>Upon completion, the Search API will return the number of matching postings for
each unique field value, rather than individual postings themselves.  For
example, a count by status might return the following:</p>
<blockquote>
<p>registered = 816 <br>
for_sale = 4,612 <br>
for_hire = 1,208 <br>
wanted = 319 <br>
lost = 57 <br>
stolen = 63 <br>
found = 36   </p>
</blockquote>
<h3>Calling the 3taps Search API</h3>
<p>The Search API is accessed via a single entry point, which can be found at the
following URL:</p>
<blockquote>
<pre><code>http://search.3taps.com
</code></pre>
</blockquote>
<p>The Search API call is made using an HTTP <code>GET</code> request to the above URL.  To
make a search request, pass the following parameters in addition to the search
criteria themselves:</p>
<blockquote>
<p><code>auth_token</code> <em>(required)</em></p>
<blockquote>
<p>The authentication token used to ensure that you are authorized to make
this API call.</p>
</blockquote>
<p><code>rpp</code> <em>(optional)</em></p>
<blockquote>
<p>The desired number of results per page.  This defaults to 10, but can be
set to any value from 1 to 100 for ordinary searches, and up to 10,000 for
index-only searches, as described above.</p>
</blockquote>
<p><code>retvals</code> <em>(optional)</em></p>
<blockquote>
<p>A string listing the fields which should be returned back to the caller.
The various fields should be separated by commas.  At present, the
following fields can be included in this parameter:</p>
<blockquote>
<p><strong>id</strong> <br>
<strong>account_id</strong> <br>
<strong>source</strong> <br>
<strong>category</strong> <br>
<strong>category_group</strong> <br>
<strong>location</strong> <br>
<strong>external_id</strong> <br>
<strong>external_url</strong> <br>
<strong>heading</strong> <br>
<strong>body</strong> <br>
<strong>timestamp</strong> <br>
<strong>timestamp_deleted</strong> <br>
<strong>expires</strong> <br>
<strong>language</strong> <br>
<strong>price</strong> <br>
<strong>currency</strong> <br>
<strong>images</strong> <br>
<strong>annotations</strong> <br>
<strong>status</strong> <br>
<strong>state</strong> <br>
<strong>immortal</strong> <br>
<strong>deleted</strong> <br>
<strong>flagged_status</strong>   </p>
</blockquote>
<p>If no <code>retvals</code> parameter is provided, the following default will be used:</p>
<blockquote>
<p><strong>id</strong>
<strong>source</strong> <br>
<strong>category</strong> <br>
<strong>location</strong> <br>
<strong>external_id</strong> <br>
<strong>external_url</strong> <br>
<strong>heading</strong> <br>
<strong>timestamp</strong>   </p>
</blockquote>
</blockquote>
<p><code>sort</code> <em>(optional)</em></p>
<blockquote>
<p>A string indicating the desired sort order to use for the found postings.
The following sort orders are currently supported:</p>
<blockquote>
<p><strong>timestamp</strong></p>
<blockquote>
<p>Sort the postings in ascending order of timestamp (ie, oldest to
newest).</p>
</blockquote>
<p><strong>-timestamp</strong></p>
<blockquote>
<p>Sort the postings in descending order of timestamp (ie, newest to
oldest).</p>
</blockquote>
<p><strong>price</strong></p>
<blockquote>
<p>Sort the postings in ascending order of price (ie, cheapest to most
expensive).</p>
</blockquote>
<p><strong>-price</strong></p>
<blockquote>
<p>Sort the postings in descending order of price (ie, most expensive to
cheapest).</p>
</blockquote>
<p><strong>distance</strong></p>
<blockquote>
<p>Sort the postings in ascending order of distance (ie, closest to
furthest) from the point defined by the <code>lat</code> and <code>long</code> parameters.</p>
</blockquote>
</blockquote>
<p>If no <code>sort</code> parameter is provided, a default value of <code>-timestamp</code> will
be used (ie, sorting from newest to oldest).</p>
<blockquote>
<hr>
<p><strong>WARNING</strong>: when sorting the postings by price, make sure you include a
currency in the search criteria.  Otherwise, the search results will
include postings in different currencies, and the sort order will be
meaningless.</p>
<hr>
</blockquote>
</blockquote>
<p><code>count</code> <em>(optional)</em></p>
<blockquote>
<p>A string containing the field to use for calculating the count.  Supplying
this parameter enables count mode.  The following values can be supplied
for this parameter:</p>
<blockquote>
<p><strong>source</strong> <br>
<strong>category</strong> <br>
<strong>category_group</strong> <br>
<strong>location.country</strong> <br>
<strong>location.state</strong> <br>
<strong>location.metro</strong> <br>
<strong>location.region</strong> <br>
<strong>location.county</strong> <br>
<strong>location.city</strong> <br>
<strong>location.locality</strong> <br>
<strong>location.zipcode</strong> <br>
<strong>language</strong> <br>
<strong>currency</strong> <br>
<strong>status</strong> <br>
<strong>state</strong> <br>
<strong>flagged_status</strong>   </p>
</blockquote>
</blockquote>
</blockquote>
<p>Upon completion, the Search API will send back a response with a Content-Type
of <code>application/json</code>, and the body of the response will be a JSON-formatted
object.  The contents of this object will vary depending on whethe the search
API was called in search mode or count mode.</p>
<h4>Search Mode Results</h4>
<p>In search mode, the JSON-formatted object returned in the body of the HTTP
response will include the following fields:</p>
<blockquote>
<p><code>success</code></p>
<blockquote>
<p>A boolean indicating whether or not the search request succeeded.</p>
</blockquote>
<p><code>error</code></p>
<blockquote>
<p>If the search request was not successfully processed, this will be a string
describing what went wrong.</p>
</blockquote>
<p><code>anchor</code></p>
<blockquote>
<p>This will be a string that can be used in subsequent search requests to
ensure that the pagination is consistent even if new postings are received.
See above for details.</p>
</blockquote>
<p><code>next_page</code></p>
<blockquote>
<p>The "page" value to use to obtain the next set of search results.   If
there are no more results, a value of -1 will be returned.</p>
</blockquote>
<p><code>next_tier</code></p>
<blockquote>
<p>The "tier" value to use to obtain the next set of search results.  If there
are no more results, a value of -1 will be returned.</p>
</blockquote>
<p><code>postings</code></p>
<blockquote>
<p>An array containing the found postings, in the order specified by the
<code>sort=...</code> parameter.  Each entry in this array will be an object with all
or some of the following fields, depending on the value of the <code>retvals</code>
parameter, above:</p>
<blockquote>
<p><code>id</code></p>
<blockquote>
<p>The internal record ID used to uniquely identify this posting.  Note
that this will be a (possibly very large) integer.</p>
</blockquote>
<p><code>account_id</code></p>
<blockquote>
<p>A string identifying the user who submitted the posting.</p>
</blockquote>
<p><code>source</code></p>
<blockquote>
<p>The code for the source system where this posting originated from.</p>
</blockquote>
<p><code>category</code></p>
<blockquote>
<p>The 3taps category code for this posting.</p>
</blockquote>
<p><code>category_group</code></p>
<blockquote>
<p>The 3taps category group code for this posting.</p>
</blockquote>
<p><code>location</code></p>
<blockquote>
<p>An object with some or all of the following fields:</p>
<blockquote>
<p><code>lat</code></p>
<blockquote>
<p>The latitude of this posting, in decimal degrees.</p>
</blockquote>
<p><code>long</code></p>
<blockquote>
<p>The longitude of this posting, in decimal degrees.</p>
</blockquote>
<p><code>accuracy</code></p>
<blockquote>
<p>An integer indicating the accuracy of the supplied lat/long value.</p>
</blockquote>
<p><code>country</code></p>
<blockquote>
<p>The 3taps country code for this posting.</p>
</blockquote>
<p><code>state</code></p>
<blockquote>
<p>The 3taps state code for this posting.</p>
</blockquote>
<p><code>metro</code></p>
<blockquote>
<p>The 3taps metro area code for this posting.</p>
</blockquote>
<p><code>region</code></p>
<blockquote>
<p>The 3taps region code for this posting.</p>
</blockquote>
<p><code>county</code></p>
<blockquote>
<p>The 3taps county code for this posting.</p>
</blockquote>
<p><code>city</code></p>
<blockquote>
<p>The 3taps city code for this posting.</p>
</blockquote>
<p><code>locality</code></p>
<blockquote>
<p>The 3taps locality code for this posting.</p>
</blockquote>
<p><code>zipcode</code></p>
<blockquote>
<p>The 3taps ZIP code for this posting.</p>
</blockquote>
<p><code>formatted_address</code></p>
<blockquote>
<p>A string containing the address associated with this posting as a
one-line string, if this information is available.</p>
</blockquote>
</blockquote>
</blockquote>
<p><code>external_id</code></p>
<blockquote>
<p>A string that uniquely identifies the posting in the source system.</p>
</blockquote>
<p><code>external_url</code></p>
<blockquote>
<p>A URL pointing to the original posting.</p>
</blockquote>
<p><code>heading</code></p>
<blockquote>
<p>A string containing the heading for this posting.</p>
</blockquote>
<p><code>body</code></p>
<blockquote>
<p>A string containing the body of this posting, in plain (unformatted)
text.</p>
</blockquote>
<p><code>timestamp</code></p>
<blockquote>
<p>The date and time at which the posting was created, as an integer
number of seconds since the 1st of January 1970 ("unix time"), in UTC.</p>
</blockquote>
<p><code>timestamp_deleted</code></p>
<blockquote>
<p>The date and time at which the posting was deleted, as an integer
number of seconds since the 1st of January 1970 ("unix time"), in UTC.</p>
</blockquote>
<p><code>expires</code></p>
<blockquote>
<p>The date and time at which this posting should expire, as an integer
number of seconds since the 1st of January 1970 ("unix time"), in UTC. </p>
</blockquote>
<p><code>language</code></p>
<blockquote>
<p>The 2-character ISO 639-1 language code indicating which language the
posting is in.</p>
</blockquote>
<p><code>price</code></p>
<blockquote>
<p>The price associated with this posting, if any.</p>
</blockquote>
<p><code>currency</code></p>
<blockquote>
<p>The 3-character ISO-4217 currency code indicating which currency the
price is in.</p>
</blockquote>
<p><code>images</code></p>
<blockquote>
<p>An array of image objects representing the images associated with this
posting. Each image object can have the following fields:</p>
<blockquote>
<p><code>full</code></p>
<blockquote>
<p>The URL pointing to the full-sized image for this posting.</p>
</blockquote>
<p><code>full_width</code></p>
<blockquote>
<p>The width, in pixels, for the full-sized image, if known.</p>
</blockquote>
<p><code>full_height</code></p>
<blockquote>
<p>The height, in pixels, for the full-sized image, if known.</p>
</blockquote>
<p><code>thumbnail</code></p>
<blockquote>
<p>The URL pointing to a thumbnail-sized image for this posting.</p>
</blockquote>
<p><code>thumbnail_width</code></p>
<blockquote>
<p>The width, in pixels, for the thumbnail-sized image, if known.</p>
</blockquote>
<p><code>thumbnail_height</code></p>
<blockquote>
<p>The height, in pixels, for the thumbnail-sized image, if known.</p>
</blockquote>
</blockquote>
</blockquote>
<p><code>annotations</code></p>
<blockquote>
<p>A object holding the various annotations to associate with this
posting. Each field in this object maps the annotation name to its
associated value, formatted as a string.</p>
</blockquote>
<p><code>status</code></p>
<blockquote>
<p>The posting's current status.  This will be one of the following
values:</p>
<blockquote>
<p><code>registered</code> <br>
<code>for_sale</code> <br>
<code>for_hire</code> <br>
<code>for_rent</code><br>
<code>wanted</code> <br>
<code>lost</code> <br>
<code>stolen</code> <br>
<code>found</code>   </p>
</blockquote>
</blockquote>
<p><code>state</code></p>
<blockquote>
<p>The current state of the posting.  This will be one of the following
values:</p>
<blockquote>
<p><code>available</code> <br>
<code>unavailable</code> <br>
<code>expired</code>   </p>
</blockquote>
</blockquote>
<p><code>immortal</code></p>
<blockquote>
<p><strong>true</strong> if the posting is immortal (ie, never expires), <strong>false</strong>
otherwise.</p>
</blockquote>
<p><code>deleted</code></p>
<blockquote>
<p><strong>true</strong> if the posting is deleted, <strong>false</strong> otherwise.</p>
</blockquote>
<p><code>flagged_status</code></p>
<blockquote>
<p>A number indicating the current "flagged" status of the posting.  This
will be one of the following values:</p>
<blockquote>
<p><code>0</code> = The posting has never been flagged. <br>
<code>1</code> = The posting has been flagged by a user. <br>
<code>2</code> = The flagged status was overruled.   </p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p><code>num_matches</code></p>
<blockquote>
<p>The total number of matching postings found by this search.  Note that this
is the number of matching postings in the database, not the number of
postings actually returned in the current page of search results.</p>
</blockquote>
<p><code>time_taken</code></p>
<blockquote>
<p>The total time taken to process this search request, in milliseconds.  The
total search time consists of the time taken to identify the matching
records (<code>time_search</code>), plus the time taken to fetch the desired set of
fields from those matching records (<code>time_fetch</code>).</p>
</blockquote>
<p><code>time_search</code></p>
<blockquote>
<p>The time taken to identify the matching records, in milliseconds.</p>
</blockquote>
<p><code>time_fetch</code></p>
<blockquote>
<p>The time taken to fetch the search results once the matching records have
been identified, in milliseconds.  Note that this is only available for
tier 0 searches.</p>
</blockquote>
</blockquote>
<p>After making the initial search request, you can ask for more pages of results
by reissuing the search request with the following additional parameters:</p>
<blockquote>
<p><code>anchor</code></p>
<blockquote>
<p>The anchor value returned by the Search API when the first request was
made.</p>
</blockquote>
<p><code>page</code></p>
<blockquote>
<p>The page number for the desired page of postings.  You should use the value
returned by the previous call to the Search API in the <code>next_page</code> field to
obtain the next page of search results.</p>
</blockquote>
<p><code>tier</code></p>
<blockquote>
<p>Which tier to use for the search.  You should use the value of returned by
the previous call to the Search API in the <code>next_tier</code> field to ensure that
you continue to search all the available postings in the 3taps system.</p>
</blockquote>
</blockquote>
<p><strong>WARNING:</strong> Make sure you also include the other parameters you passed when
making the original search request, in particular the search criteria and the
<code>rpp</code> value.  Changing these will result in the wrong set of postings being
returned.</p>
<p>The response will be the same as for the initial search request, with the
addition of one extra field in the returned JSON object:</p>
<blockquote>
<p><code>new_postings</code></p>
<blockquote>
<p>This is the number of new postings which have been added to the database
since the initial search request was made.</p>
</blockquote>
</blockquote>
<p>Note that if new postings have come in, you can find these postings by
reissuing the search request without the <code>anchor</code> parameter.</p>
<h4>Count Mode Results</h4>
<p>In count mode, the JSON-formatted object returned in the body of the HTTP
response will include the following fields:</p>
<blockquote>
<p><code>success</code></p>
<blockquote>
<p>A boolean indicating whether or not the search request succeeded.</p>
</blockquote>
<p><code>error</code></p>
<blockquote>
<p>If the search request was not successfully processed, this will be a string
describing what went wrong.</p>
</blockquote>
<p><code>num_matches</code></p>
<blockquote>
<p>The total number of matching postings found by this search.</p>
</blockquote>
<p><code>counts</code></p>
<blockquote>
<p>An array of values holding the various field values and the number of
matching postings with that field value.  For example, when performing a
search with <code>count=status</code>, the JSON object will include something like the
following:</p>
<blockquote>
<pre><code> "counts": [{"count": 816, "term": "registered"},
            {"count": 4612, "term": "for_sale"},
            {"count": 1208, "term": "for_hire"},
            {"count": 910,  "term": "for_rent"},
            {"count": 319, "term": "wanted"},
            {"count": 57, "term": "lost"},
            {"count": 63, "term": "stolen"},
            {"count": 36, "term": "found"}]
</code></pre>
</blockquote>
<p>As you can see, each item in the returned array is an object with <code>count</code>
and <code>term</code> fields, where <code>term</code> is the value of the count field, and
<code>count</code> is the number of matching postings with that count field value.</p>
</blockquote>
<p><code>time_taken</code></p>
<blockquote>
<p>The total time taken to process this search request, in milliseconds.</p>
</blockquote>
<p><code>time_search</code></p>
<blockquote>
<p>The time taken to identify the matching records, in milliseconds.</p>
</blockquote>
</blockquote>
      </div>
    </div>
  

</body></html>